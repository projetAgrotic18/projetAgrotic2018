 						# Début du fichier .map

#########################   CARACTERISTIQUES DE L'IMAGE EN SORTIE     #############################
MAP
NAME CartePACAWMS
    OUTPUTFORMAT 
        NAME png
        DRIVER "GD/PNG"
        MIMETYPE "image/png"
        IMAGEMODE PC256
        EXTENSION "png"
        TRANSPARENT ON
        FORMATOPTION "INTERLACE=ON"
        FORMATOPTION "TRANSPARENT=ON"
    END	
#########################   Métadonnées de la carte pour la requête WMS GETCAPABILITIES     #############################
WEB
    METADATA
        "wms_title" "WMS_Miniprojet"
        "wms_onlinesource" "http://194.199.251.68/cgi-bin/mapserv.exe?map=/projetAgrotic2018/carte/cartepaca3857.map&"
        "wms_srs" "EPSG:3857"
        "ows_enable_request" "*"
    END
END
PROJECTION
    "init=epsg:3857"
END
EXTENT 470912 5309234 859045 5641512 
SIZE 600 600
FONTSET "D:/ms4w/Apache/htdocs/projetAgrotic2018/carte/fonts/fonts.txt"
SYMBOLSET "symbols.sym"
#LEGEND
   # KEYSIZE 20 15
  #  LABEL
  #      TYPE TRUETYPE 
  #      FONT fritqat 
  #      SIZE 10 
  #      COLOR 0 0 0 
  #  END
 #   STATUS EMBED 
 #   POSITION LL
#END
#################################    DEFINITION DES COUCHES   #####################################
#################################         Couche Département          #####################################
	LAYER 						
		NAME departements
        CONNECTIONTYPE postgis
        CONNECTION "user=postgres dbname=te host=194.199.251.68 password=postgre port=5432"
        DATA "geom from departementpaca"
        PROJECTION                         
        "init=epsg:3857"
        END	
		METADATA         		
            "wms_title" "WMS_Depart"
            "wms_onlineresource" "http://194.199.251.68/cgi-bin/mapserv.exe?map=D:/ms4w/Apache/htdocs//projetAgrotic2018/carte/cartepaca3857.map&"
        END		
		STATUS       OFF   	
		TYPE         POLYGON			
        CLASS		                     
            NAME "Departements PACA"
            STYLE
                OUTLINECOLOR  0 0 0
                WIDTH 5
            END
        END
    END    
 #################################         Couche Département libellé          #####################################

	LAYER 						
		NAME departementslibelle
        CONNECTIONTYPE postgis
        CONNECTION "user=postgres dbname=te host=194.199.251.68 password=postgre port=5432"
        DATA "geom from departementpaca"
        PROJECTION                         
        "init=epsg:3857"
        END	
		METADATA         		
            "wms_title" "WMS_Depart"
            "wms_onlineresource" "http://194.199.251.68/cgi-bin/mapserv.exe?map=D:/ms4w/Apache/htdocs//projetAgrotic2018/carte/cartepaca3857.map&"
        END		
		STATUS       OFF   # remplacer par off	
		TYPE         POLYGON			
        LABELITEM "nom_dept"
        CLASS		                     
            NAME "Departements PACA"
            STYLE
                OUTLINECOLOR  115 8 0
                SIZE 50
            END
            LABEL 
                COLOR 0 0 0
                TYPE TRUETYPE
                FONT fritqat
                SIZE 8
                ANTIALIAS TRUE
                POSITION CC
                PARTIALS FALSE
            END
        END
    END    
#################################         Couche Communes         #####################################

	LAYER 						
		NAME communes
        CONNECTIONTYPE postgis
        CONNECTION "user=postgres dbname=te host=194.199.251.68 password=postgre port=5432"
        DATA "geom3857 from communepaca"
        PROJECTION                         
        "init=epsg:3857"
        END	
		METADATA         		
            "wms_title" "WMS_commune"
            "wms_onlineresource" "http://194.199.251.68/cgi-bin/mapserv.exe?map=D:/ms4w/Apache/htdocs//projetAgrotic2018/carte/cartepaca3857.map&"
        END		
		STATUS       OFF   	
		TYPE         POLYGON			
        LABELITEM "nom_comm"
        CLASS		                     
            NAME "Departements PACA"
            STYLE
                OUTLINECOLOR  0 0 0
            END
        END
    END
#################################         Couche Exploitation         #####################################
	LAYER 						
		NAME exploitations
        CONNECTIONTYPE postgis
        CONNECTION "user=postgres dbname=te host=194.199.251.68 password=postgre port=5432"
        DATA "geom from exploitation2"
        PROJECTION                         
        "init=epsg:3857"
        END	
		METADATA         		
            "wms_title" "WMS_exploitation"
            "wms_onlineresource" "http://194.199.251.68/cgi-bin/mapserv.exe?map=D:/ms4w/Apache/htdocs//projetAgrotic2018/carte/cartepaca3857.map&"
        END		
		STATUS       OFF  	
		TYPE         POINT
        CLASS	
            NAME "Exploitation"
            STYLE
                SYMBOL "point"
                SIZE 8
                COLOR 204 85 0
                OUTLINECOLOR 204 85 0
            END
        END
    END 
    
#################################         Couche zone de protection       #####################################
	LAYER 						
		NAME zoneprot
        CONNECTIONTYPE postgis
        CONNECTION "user=postgres dbname=te host=194.199.251.68 password=postgre port=5432"
        DATA "geom from (select geom, id_zone_tampon, date_fin, libelle_maladie FROM zonetampon zt JOIN maladie ma ON zt.id_maladie=ma.id_maladie) as tampon using unique id_zone_tampon using srid=3857"
        PROJECTION                         
        "init=epsg:3857"
        END	
		METADATA         		
            "wms_title" "WMS_exploitation"
            "wms_onlineresource" "http://localhost/cgi-bin/mapserv.exe?map=/ms4w/Apache/htdocs/ProjetPACA/cartepaca2.map&"
            "wms_include_items" "all"
            "gml_include_items" "all"
            "ows_include_items" "all"
            "ows_geometries" "geom"
            "ows_the_geom_type" "multipolygon"
        END
        DUMP TRUE
		STATUS       OFF  	
		TYPE         POLYGON
        CLASS	
            NAME "zone tampon"
            STYLE
                COLOR 204 85 0 
                OUTLINECOLOR 0 0 0
                WIDTH 4
                OPACITY 40
            END
        END
        HEADER "entete.html"
        TEMPLATE "corps.html"
        FOOTER "pied.html"
    END
#################################         Couche troupeau         #####################################
	LAYER 						
		NAME troupeaux
        CONNECTIONTYPE postgis
        CONNECTION "user=postgres dbname=te host=194.199.251.68 password=postgre port=5432"
        DATA "geom from troupeaux2"
        PROJECTION                         
        "init=epsg:3857"
        END	
		METADATA         		
            "wms_title" "WMS_exploitation"
            "wms_onlineresource" "http://194.199.251.68/cgi-bin/mapserv.exe?map=D:/ms4w/Apache/htdocs//projetAgrotic2018/carte/cartepaca3857.map&"
        END		
		STATUS       OFF  	
		TYPE         POINT
        CLASS	
            NAME "Troupeaux"
            STYLE
                SYMBOL "point"
                SIZE 8
                COLOR 0 0 0
                OUTLINECOLOR 0 0 0
            END
        END
    END
END	


http://194.199.251.68/cgi-bin/mapserv.exe?map=D:/ms4w/Apache/htdocs//projetAgrotic2018/carte/cartepaca3857.map&&SERVICE=WMS&VERSION=1.1.1&REQUEST=Getmap&layers=departements,exploitation,troupeaux&SRS=EPSG:3857&BBOX=470912,5309234,859045,5641512&FORMAT=image/png&WIDTH=600&HEIGHT=600


http://localhost/cgi-bin/mapserv.exe?map=/ms4w/Apache/htdocs/Luchey/w03/cartepaca3857.map&SERVICE=WMS&TRANSPARENT=TRUE&VERSION=1.3.0&REQUEST=GetCapabilities