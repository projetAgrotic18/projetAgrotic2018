<?php session_start(); ?>
<html>
    <head>
        <title>Liste des exploitations</title>
		<META charset="UTF-8"/>
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

    </head>
    <body>
    	<!-- Entête -->
    
    	<!-- DIV Navigation (Menus) -->
        <?php include("../general/Front/navigation.php"); ?>
        
        <!--Deux lignes de code pour le tableau-->
		<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css"/>
		<script type="text/javascript" src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>

		
		<div class="padding">
			<h2>Liste des exploitations</h2>
			
				<?php
        		// Connexion, sélection de la base de données du projet
        		$connex = new connexionPostgreSQL();
				
				$result_all_exp =  $connex->requete("SELECT cu.nom, v.nom_exploitation, v.adresse, v.nom_commune, v.code_postal, v.libelle_dep, v.id_visite, v.date_visite FROM v_liste_exploit_proph v JOIN compte_utilisateur cu ON v.id_compte=cu.id_compte");
				
				$nbr_col = pg_num_fields($result_all_exp);
				?>
				
				<TABLE border=1 id="example">
					<THEAD>
						<TR>
							<TH>Nom de l'exploitant</TH>
							<TH>Nom de l'exploitation</TH>
							<TH>Adresse</TH>
							<TH>Commune</TH>
							<TH>Code Postal</TH>
							<TH>Département</TH>
							<TH>Identifiant visite de prophylaxie</TH>
							<TH>Date visite de prophylaxie</TH>
						</TR>
					</THEAD>
					<TBODY>
						<?php
						while ($row = pg_fetch_array($result_all_exp)){
							echo "<TR>";
								for ($i=0; $i<$nbr_col; $i++){
									echo "<td>".$row[$i]."</td>";
								}
							echo "</TR>";
						}
						?>
					</TBODY>
				</TABLE>
			<BR/>		
			<input type="button" value="Retour" onclick="self.history.back()">
		</div>
    
		 <!-- Pied de page -->		
        <?php include("../general/front/footer.html"); ?>	
        
        
         <!-- Section Javascript : définition de la fonction gérant l'affichage de l'annuaire -->
        <script type="text/javascript">
			//Code pour la mise en forme du tableau (voir datatable)
			$(document).ready(function() {
				$('#example').DataTable();
			});
		</script>
		
	</body>
</html>